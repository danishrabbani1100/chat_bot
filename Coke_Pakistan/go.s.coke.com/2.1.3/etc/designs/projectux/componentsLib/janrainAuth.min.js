var GO=GO||{};
GO.Janrain=GO.Janrain||{};
GO.Janrain.AuthIntegration=GO.Janrain.AuthIntegration||{};
GO.Janrain.AuthIntegration=new (function(){function e(f){if(window.ConsumerDbSdk){ConsumerDbSdk.eventBus.ready(function(){var g={exp:(janrain.settings.capture.accessTokenLifeHours||1)*60*60,uuid:janrain.capture.ui.getReturnExperienceData("uuid"),path:f||window.location.href.replace(window.location.origin,"").split("?")[0].replace("/cf#","").replace(".html","").split("#")[0]};
ConsumerDbSdk.eventBus.subscribe("onCaptureSessionFound",function(h){d(g)
});
ConsumerDbSdk.eventBus.subscribe("onCaptureSessionNotFound",function(h){c()
})
})
}}function d(f){$.ajax({url:"/bin/goservices/cidusernamedata",data:{uuid:f.uuid,path:f.path}}).done(function(i,k,j){var g=i.displayName;
var h=i.givenName;
f=$.extend({},f,{displayName:(g||h),id:i.id||""});
a(f)
}).fail(function(h,i,g){c()
})
}function a(f){$.ajax({url:"/bin/goservices/livefyreauthtoken",dataType:"json",data:{path:f.path,displayname:f.displayName,id:f.id,exp:f.exp}}).done(function(g,i,h){b(g.lf_token)
}).fail(function(h,i,g){c()
})
}function c(){if(!window.Livefyre){return
}Livefyre.require(["auth"],function(f){f.delegate({login:function(g){janrain.capture.ui.renderScreen("signIn")
},logout:function(g){g(null)
}});
f.logout()
})
}function b(f){if(!window.Livefyre||!f){return
}Livefyre.require(["auth"],function(g){g.authenticate({livefyre:f});
g.delegate({login:function(h){janrain.capture.ui.renderScreen("signIn")
},logout:function(h){h(null);
janrain.capture.ui.endCaptureSession()
},editProfile:function(h){$("#captureProfileLink").trigger("click")
}})
})
}return{init:e}
})();